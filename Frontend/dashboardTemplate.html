<!DOCTYPE html>
<html>
<head>
    <script src="jquery-3.4.1.min.js"></script>
    <meta charset="utf-8"/>
    <title>Dashboard</title>
</head>
<body>
<h1>Neue Aktivität hochladen</h1>
<form  enctype="multipart/form-data" action="uploadHandler" method="post">
    <label>Art der Aktivität:</label><br>
    <select name="activity" size="2" required="required">
        <option>Laufen</option>
        <option>Radfahren</option>
    </select><br><br>
    <label>Kommentare</label><br>
    <textarea name="kommentare" rows="10" cols="50"></textarea><br><br>
    <label>GPX_Datei zum hochladen auswählen:</label><br>
    <input name="datei" type="file" size="50" accept="" required="required"><br><br>
    <button>Hochladen</button>
</form>
<h1>Ihre Aktivitäten</h1>

<script>
    function remove(){
        var actID = $(event.target).parent().parent()[0].firstElementChild.textContent;
        alert(actID);
        $(event.target).parent().parent().remove()
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.open( "POST", "/removeActivity");
        xmlHttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded')
        xmlHttp.send("actID="+actID);
    }
    function edit(){
        var actID = $(event.target).parent().parent(0).children(0)[0];
        var actArt = $(event.target).parent().parent(0).children(0)[1];
        var comment = $(event.target).parent().parent(0).children(0)[2];
        var button = $(event.target);
        if (button[0].innerText=="speichern"){
            var xmlHttp = new XMLHttpRequest();
            xmlHttp.open( "POST", "/editActivity");
            xmlHttp.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');
            xmlHttp.send("actID="+actID.innerText +"&actArt="+actArt.innerText+"&comment="+comment.innerText);

            actArt.setAttribute('contenteditable','false');
            comment.setAttribute('contenteditable','false');
            actArt.setAttribute('bgcolor','#FFFFFF');
            comment.setAttribute('bgcolor','#FFFFFF');

            button[0].innerText = "edit";

        }else{
            //make editable
            actArt.setAttribute('contenteditable','true');
            comment.setAttribute('contenteditable','true');
            actArt.setAttribute('bgcolor','#FF0000');
            comment.setAttribute('bgcolor','#FF0000');
            button[0].innerText = "speichern";
        }
    }
</script>
<table>
  <tr>
    <th>ActivityID</th>
    <th>Art der Aktivität</th>
    <th>Kommentar</th>
    <th>Gesamtdistanz</th>
    <th>Standzeit</th>
	<th>Maximalgeschwindigkeit</th>
	<th>Maximalgeschwindigkeit am Zeitpunkt</th>
    <th>Durchschnittsgeschwindigkeit</th>
    <th>Durchschnittsgeschwindigkeit schnellster Kilometer</th>
	<th>schnellster KM</th>
    <th>Durchschnittsgeschwindigkeit langsamster Kilometer</th>
    <th>langsamster KM</th>
  </tr>
    {{range .Activities}}
    <tr>
        <td>{{.ActID}}</td>
        <td>{{.Activityart}}</td>
        <td>{{.Comment}}</td>
        <td>{{.Distance}} km</td>
        <td>{{.Standzeit}} s</td>
        <td>{{.HighSpeed}} M/s</td>
        <td>{{.Highspeedtime}}</td>
        <td>{{.Avgspeed}} M/s</td>
        <td>{{.AvgSpeedFastKM}}</td>
        <td>{{.AvgSpeedFastMS}} M/s</td>
        <td>{{.AvgSpeedSlowKM}}</td>
        <td>{{.AvgSpeedSlowMS}} M/s</td>
        <td><button onclick="edit()">Edit</button><button onclick="remove()">Delete</button></td>
    </tr>
    {{end}}
   <tr>
</table>

</body>
</html>